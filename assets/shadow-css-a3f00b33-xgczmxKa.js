import{_ as k}from"./index-DPMakUq_.js";/**
 * @license
 * Copyright Google Inc. All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 *
 * This file is a port of shadowCSS from webcomponents.js to TypeScript.
 * https://github.com/webcomponents/webcomponentsjs/blob/4efecd7e0e/src/ShadowCSS/ShadowCSS.js
 * https://github.com/angular/angular/blob/master/packages/compiler/src/shadow_css.ts
 */var T=function(r){var t=[],e=0,a;r=r.replace(/(\[[^\]]*\])/g,function(n,i){var c="__ph-"+e+"__";return t.push(i),e++,c}),a=r.replace(/(:nth-[-\w]+)(\([^)]+\))/g,function(n,i,c){var l="__ph-"+e+"__";return t.push(c),e++,i+l});var o={content:a,placeholders:t};return o},P=function(r,t){return t.replace(/__ph-(\d+)__/g,function(e,a){return r[+a]})},_="-shadowcsshost",b="-shadowcssslotted",y="-shadowcsscontext",O=")(?:\\(((?:\\([^)(]*\\)|[^)(]*)+?)\\))?([^,{]*)",B=new RegExp("("+_+O,"gim"),M=new RegExp("("+y+O,"gim"),N=new RegExp("("+b+O,"gim"),m=_+"-no-combinator",D=/-shadowcsshost-no-combinator([^\s]*)/,I=[/::shadow/g,/::content/g],K="([>\\s~+[.,{:][\\s\\S]*)?$",R=/-shadowcsshost/gim,U=/:host/gim,A=/::slotted/gim,Y=/:host-context/gim,$=/\/\*\s*[\s\S]*?\*\//g,q=function(r){return r.replace($,"")},z=/\/\*\s*#\s*source(Mapping)?URL=[\s\S]+?\*\//g,F=function(r){return r.match(z)||[]},G=/(\s*)([^;\{\}]+?)(\s*)((?:{%BLOCK%}?\s*;?)|(?:\s*;))/g,J=/([{}])/g,Q="{",V="}",C="%BLOCK%",w=function(r,t){var e=X(r),a=0;return e.escapedString.replace(G,function(){for(var o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];var i=o[2],c="",l=o[4],s="";l&&l.startsWith("{"+C)&&(c=e.blocks[a++],l=l.substring(C.length+1),s="{");var v={selector:i,content:c},u=t(v);return""+o[1]+u.selector+o[3]+s+u.content+l})},X=function(r){for(var t=r.split(J),e=[],a=[],o=0,n=[],i=0;i<t.length;i++){var c=t[i];c===V&&o--,o>0?n.push(c):(n.length>0&&(a.push(n.join("")),e.push(C),n=[]),e.push(c)),c===Q&&o++}n.length>0&&(a.push(n.join("")),e.push(C));var l={escapedString:e.join(""),blocks:a};return l},Z=function(r){return r=r.replace(Y,y).replace(U,_).replace(A,b),r},W=function(r,t,e){return r.replace(t,function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];if(a[2]){for(var n=a[2].split(","),i=[],c=0;c<n.length;c++){var l=n[c].trim();if(!l)break;i.push(e(m,l,a[3]))}return i.join(",")}else return m+a[3]})},E=function(r,t,e){return r+t.replace(_,"")+e},rr=function(r){return W(r,B,E)},tr=function(r,t,e){return t.indexOf(_)>-1?E(r,t,e):r+t+e+", "+t+" "+r+e},er=function(r,t){var e="."+t+" > ",a=[];return r=r.replace(N,function(){for(var o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];if(o[2]){for(var i=o[2].trim(),c=o[3],l=e+i+c,s="",v=o[4]-1;v>=0;v--){var u=o[5][v];if(u==="}"||u===",")break;s=u+s}var f=s+l,S=""+s.trimRight()+l.trim();if(f.trim()!==S.trim()){var g=S+", "+f;a.push({orgSelector:f,updatedSelector:g})}return l}else return m+o[3]}),{selectors:a,cssText:r}},nr=function(r){return W(r,M,tr)},or=function(r){return I.reduce(function(t,e){return t.replace(e," ")},r)},ar=function(r){var t=/\[/g,e=/\]/g;return r=r.replace(t,"\\[").replace(e,"\\]"),new RegExp("^("+r+")"+K,"m")},sr=function(r,t){var e=ar(t);return!e.test(r)},cr=function(r,t,e){if(R.lastIndex=0,R.test(r)){var a="."+e;return r.replace(D,function(o,n){return n.replace(/([^:]*)(:*)(.*)/,function(i,c,l,s){return c+a+l+s})}).replace(R,a+" ")}return t+" "+r},lr=function(r,t,e){var a=/\[is=([^\]]*)\]/g;t=t.replace(a,function(d){for(var p=[],h=1;h<arguments.length;h++)p[h-1]=arguments[h];return p[0]});var o="."+t,n=function(d){var p=d.trim();if(!p)return"";if(d.indexOf(m)>-1)p=cr(d,t,e);else{var h=d.replace(R,"");if(h.length>0){var x=h.match(/([^:]*)(:*)(.*)/);x&&(p=x[1]+o+x[2]+x[3])}}return p},i=T(r);r=i.content;for(var c="",l=0,s,v=/( |>|\+|~(?!=))\s*/g,u=r.indexOf(m)>-1,f=!u;(s=v.exec(r))!==null;){var S=s[1],g=r.slice(l,s.index).trim();f=f||g.indexOf(m)>-1;var j=f?n(g):g;c+=j+" "+S+" ",l=v.lastIndex}var H=r.substring(l);return f=f||H.indexOf(m)>-1,c+=f?n(H):H,P(i.placeholders,c)},ir=function(r,t,e,a){return r.split(",").map(function(o){return a&&o.indexOf("."+a)>-1?o.trim():sr(o,t)?lr(o,t,e).trim():o.trim()}).join(", ")},L=function(r,t,e,a,o){return w(r,function(n){var i=n.selector,c=n.content;n.selector[0]!=="@"?i=ir(n.selector,t,e,a):(n.selector.startsWith("@media")||n.selector.startsWith("@supports")||n.selector.startsWith("@page")||n.selector.startsWith("@document"))&&(c=L(n.content,t,e,a));var l={selector:i.replace(/\s{2,}/g," ").trim(),content:c};return l})},vr=function(r,t,e,a,o){r=Z(r),r=rr(r),r=nr(r);var n=er(r,a);return r=n.cssText,r=or(r),t&&(r=L(r,t,e,a)),r=r.replace(/-shadowcsshost-no-combinator/g,"."+e),r=r.replace(/>\s*\*\s+([^{, ]+)/gm," $1 "),{cssText:r.trim(),slottedSelectors:n.selectors}},fr=function(r,t,e){var a=t+"-h",o=t+"-s",n=F(r);r=q(r);var i=[];if(e){var c=function(s){var v="/*!@___"+i.length+"___*/",u="/*!@"+s.selector+"*/";return i.push({placeholder:v,comment:u}),s.selector=v+s.selector,s};r=w(r,function(s){return s.selector[0]!=="@"?c(s):((s.selector.startsWith("@media")||s.selector.startsWith("@supports")||s.selector.startsWith("@page")||s.selector.startsWith("@document"))&&(s.content=w(s.content,c)),s)})}var l=vr(r,t,a,o);return r=k([l.cssText],n).join("\n"),e&&i.forEach(function(s){var v=s.placeholder,u=s.comment;r=r.replace(v,u)}),l.slottedSelectors.forEach(function(s){r=r.replace(s.orgSelector,s.updatedSelector)}),r};export{fr as scopeCss};
